generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model alat {
  ID_ALAT          String            @id @db.VarChar(5)
  NAMA_ALAT        String?           @db.VarChar(30)
  JUMLAH_ALAT      Int
  UNIT_ALAT        String?           @db.VarChar(35)
  ALAT_LAYAK       Int               @default(0)
  ALAT_TIDAK_LAYAK Int               @default(0)
  detailPermintaan detailPermintaan?
}

model bahan {
  ID_BAHAN         String            @id @db.VarChar(4)
  NAMA_BAHAN       String?           @db.VarChar(30)
  STOCK_BAHAN      Int?
  UNIT_BAHAN       String?           @db.VarChar(10)
  detailPermintaan detailPermintaan?
}

model permintaan {
  ID_PERMINTAAN    String             @id @db.VarChar(13)
  ID_USER          Int?
  TGL_PERMINTAAN   DateTime?          @default(now()) @db.Date
  STATUS           STATUS_PERMINTAAN? @default(PENDING)
  detailPermintaan detailPermintaan[]
  user             user?              @relation(fields: [ID_USER], references: [ID_USER], onDelete: Restrict, onUpdate: Restrict, map: "FK_RELATIONSHIP_1")

  @@index([ID_USER], map: "FK_RELATIONSHIP_1")
}

model user {
  ID_USER    Int          @id @default(autoincrement())
  NAME       String?      @db.VarChar(35)
  USERNAME   String?      @db.VarChar(25)
  PASSWORD   String?      @db.VarChar(25)
  ROLE       String?      @db.VarChar(30)
  REGISTER   DateTime?    @default(now()) @db.Date
  permintaan permintaan[]
}

model detailPermintaan {
  ID_DETAIL_PERMINTAAN String     @id @default(cuid())
  ID_PERMINTAAN        String
  ID_ALAT              String?    @unique(map: "DetailPermintaan_ID_ALAT_key")
  ID_BAHAN             String?    @unique(map: "DetailPermintaan_ID_BAHAN_key")
  JUMLAH_ALAT          Int?
  JUMLAH_BAHAN         Int?
  alat                 alat?      @relation(fields: [ID_ALAT], references: [ID_ALAT], onDelete: Cascade, map: "DetailPermintaan_ID_ALAT_fkey")
  bahan                bahan?     @relation(fields: [ID_BAHAN], references: [ID_BAHAN], onDelete: Cascade, map: "DetailPermintaan_ID_BAHAN_fkey")
  permintaan           permintaan @relation(fields: [ID_PERMINTAAN], references: [ID_PERMINTAAN], onDelete: Cascade, map: "DetailPermintaan_ID_PERMINTAAN_fkey")

  @@index([ID_PERMINTAAN], map: "DetailPermintaan_ID_PERMINTAAN_key")
}

enum STATUS_PERMINTAAN {
  PENDING
  DIVERIFIKASI
  DITERIMA
}
