generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model alat {
  ID_ALAT           String              @id
  NAMA_ALAT         String?
  JUMLAH_ALAT       Int
  UNIT_ALAT         String?
  ALAT_LAYAK        Int                 @default(0)
  ALAT_TIDAK_LAYAK  Int                 @default(0)
  detail_permintaan detail_permintaan[]
}

model bahan {
  ID_BAHAN          String              @id
  NAMA_BAHAN        String?
  STOCK_BAHAN       Int?
  UNIT_BAHAN        String?
  detail_permintaan detail_permintaan[]
}

model permintaan {
  ID_PERMINTAAN     String              @id
  ID_USER           Int?
  TGL_PERMINTAAN    DateTime?           @default(now())
  STATUS            STATUS_PERMINTAAN?  @default(PENDING)
  detail_permintaan detail_permintaan[]
  user              user?               @relation(fields: [ID_USER], references: [ID_USER], onDelete: Cascade, onUpdate: Restrict)

  @@index([ID_USER])
}

model user {
  ID_USER    Int          @id @default(autoincrement())
  NAME       String?
  USERNAME   String?
  PASSWORD   String?
  ROLE       String?
  REGISTER   DateTime?    @default(now())
  permintaan permintaan[]
}

model detail_permintaan {
  ID_DETAIL_PERMINTAAN String     @id @default(cuid())
  ID_PERMINTAAN        String
  ID_ALAT              String?
  ID_BAHAN             String?
  JUMLAH_ALAT          Int?
  JUMLAH_BAHAN         Int?
  alat                 alat?      @relation(fields: [ID_ALAT], references: [ID_ALAT], onDelete: Cascade)
  bahan                bahan?     @relation(fields: [ID_BAHAN], references: [ID_BAHAN], onDelete: Cascade)
  permintaan           permintaan @relation(fields: [ID_PERMINTAAN], references: [ID_PERMINTAAN], onDelete: Cascade)

  @@index([ID_PERMINTAAN])
}

enum STATUS_PERMINTAAN {
  PENDING
  DIVERIFIKASI
  DITERIMA
}
